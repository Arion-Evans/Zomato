---
title: "Something about Zomato"
author: "Arion Barzoucas-Evans (s3650046) & Joshua Grosman (insert student number)"
date: "08/08/2018"
output:
  pdf_document:
    latex_engine: xelatex
    number_sections: yes
  html_document:
    df_print: paged
    toc: no
    toc_depth: '3'
linkcolor: blue
header-includes:
     - \usepackage{float}
subtitle: MATH 1298 Analysis of Categorical Data Project Phase I
documentclass: article
bibliography: references.bib
---


\newpage

\tableofcontents

\newpage

# Introduction \label{sec1}


Zomato is a restaurant search and discovery service founded in 2008. Users can access a plethora of information about restuarants listed on Zomato, including information not available on the restaurant's own website. Such information includes the type of cuisine, opening hours, photos of the menu and the restaurant, pricing, and whetheror not the restaurant offers online delivery. Customers that visit the restaurants have the option of reviewing them and giving them a rating from 0 to 5. Higher rated restaurants receive more attention resulting in higher revenues. As such, understanding how users of Zomato rate restaurants is of great interest to restaurant owners in order to improve their business. The aim of this report is to explore the relationship of several factors like price and cuisine with Zomato ratings using publicly available data found on [Kaggle](https://www.kaggle.com/shrutimehta/zomato-restaurants-data). In phase I exploratory data analysis will be performed on the dataset, including data pre-processing, creation of new variables, and visual representation of the data. This will assist in observing and understanding any relationships present in the data. Following this, a logistic regression model will be fitted in phase II in order to predict the probability of receiving certain ratings according to the values of the chosen explanatory variables.

# Data Set

The dataset used in this report was acquired from [Kaggle](https://www.kaggle.com/shrutimehta/zomato-restaurants-data). It contains 9,551 observations each of which corresponds to a different restaurant and contains the following information:

* *Restaurant.ID*: A unique ID assigned to each restaurant.
* *Restaurant.Name*: Name of the restaurant.
* *Country.Code*: Codes corresponding to countries listed in a separate dataset.
* *City*: Name of the city where the restaurant is located.
* *Address*: Address of the restaurant.
* *Locality*: General location of the restaurant (short description).
* *Locality.Verbose*: General location of the restaurant (long description).
* *Longitude*: Longitude of the location of the restaurant (geographic coordinates).
* *Latitude*: Latitude of the location of the restaurant (geographic coordinates).
* *Cuisines*: Type of cuisine offered by the restaurant.
* *Average.Cost.for.two*: Average cost for two people (in the countries respective currency).
* *Currency*: Currency which is used at each restaurant.
* *Has.Table.booking*: Whether the restaurant offers the option to book a table or not.
* *Has.Online.delivery*: Whether the restaurant offers delivery through the internet or not.
* *Is.delivering.now*: Whether the restaurant was delivering at the time the dataset was created or not.
* *Switch.to.order.menu*: Unclear variable with only one level (No) for all observations.
* *Price.range*: Categorised price (between 1 and 4).
* *Aggregate.rating*: Aggregated rating from user votes.
* *Rating.color*: Categorised rating into a colour code.
* *Rating.text*: Response variable. Categorised rating with 6 levels (between Poor to Excellent).
* *Votes*: Number of votes used in the aggregate rating.



\newpage

# Data Preparation


In this project, the following `R` packages were used.

```{r, message = FALSE, warning=FALSE}
library(mlr)
library(data.table)
library(plyr)
library(dplyr)
library(ggplot2)
library(broom)
library(vcd)
library(knitr)
library(kableExtra)
```

```{r, message = FALSE, warning=FALSE, include=FALSE}
# custom str function
str_format <- function(df){
  df_sum = data.frame(Variable = names(df),
                  Class = sapply(df, class),
                  Cardinality = sapply(df, function(x){
                    if(class(x) == "factor"){
                      return(length(levels(x)))
                    }
                    return(length(unique(x)))
                  }),
                  Levels = sapply(df, function(x){
                    if(class(x) == "factor"){
                      return(paste0(head(levels(x)), collapse = ", "))
                    }
                    return(paste0(head(unique(x)), collapse = ", "))
                  }),
                  First_Values = sapply(df, function(x) paste0(head(x),  collapse = ", ")),
                  row.names = NULL) 
  
  colnames(df_sum)[5] = "First Values"
  colnames(df_sum)[4] = "First Levels"
  
  return(df_sum)
}
```


```{r, message = FALSE, warning=FALSE, echo=FALSE, include=FALSE}
zomato = read.csv("zomato.csv")
zomato = as.data.table(zomato)

countries = read.csv("Country-Code.csv")

```

As Table 1 indicates, there are no NA values in any of the features. Additionally, according to Table 2 restaurant ID's are unique for every restaurant while there are appears to be some duplicate restaurant names due to the existance of restaurant chains. Furthermore, each restaurant has multiple cuisines which causes the `cuisine` feature to have so many levels. Finally, the `Switch.to.order.menu` feature only has one level ("No") for the entire dataset.


```{r, message = FALSE, warning=FALSE, echo=FALSE}
kable(as.data.frame(summarizeColumns(zomato)),
      caption = "Feature summary before data preprocessing.",
      format = "latex") %>% kable_styling(latex_options = c("scale_down","HOLD_position"))

```

```{r, message = FALSE, warning=FALSE, echo=FALSE}
zomato_temp = zomato
zomato_temp[,c(2,5:7,10)] = lapply(zomato[,c(2,5:7,10)], strtrim, width = 10)

df = str_format(zomato_temp)

kable(df, caption = "Variable summary for the Zomato dataset\n9551 Observations of 21 Variables",
        format = "latex") %>% kable_styling(latex_options = c("scale_down","HOLD_position"))
```

To rectify the identified issues, all unnecessary features were removed. This includes `Restaurant.ID` (unique identifier), `Restaurant.Name` ,`Address`, `Locality`, `Locality.Verbose`, `Is.delivering.now`, `Switch.to.order.menu`, `City`, `Currency`, `Rating.color`. The `Average.Cost.for.two` is in many different currencies and the concept of what is considered expensive would be affected by socio-economic factors in each country. For this reason this feature was standardised by currency. Furthermore, the `cuisines` variable was separated into 18 new binary features using the most prevalent levels within the original `cuisines` variable. Each of these features indicates the presence or absence of that particular cuisine in the restaurant. This way, restaurants can have multiple cuisines. Using these new binary variables, a new feature, `Cuisine_Range`, was created as the sum of all the cuisine binary variables. The `Cuisine_Range` would indicate the number of different cuisines present in a restaurant which may be of interest to the model in deciding a restaurant's rating. Finally, `Has.Table.booking` and `Has.Online.delivery` were recoded into binary variables, the country table was joined to the Zomato dataset through `Country.Code` and then aggregated into a `Continent` feature. Tables 3 and 4 show the data after preprocessing.

```{r, message = FALSE, warning=FALSE, echo=FALSE}
# Scale cost by currency
zomato[,Average.Cost.for.two.Std := as.vector(scale(Average.Cost.for.two)), by=Currency]

# Reorder columns and remove original cost column
zomato = zomato[,c(1:11,22,12:21)]
zomato = zomato[,Average.Cost.for.two := NULL]

# Create new binary variables for cuisine type (1-C encoding)
splitdat = do.call("rbind", strsplit(as.character(zomato$Cuisines), ","))
unique.cuisines = as.vector(unique(as.vector(trimws(splitdat))))
current.names = as.vector(names(zomato))

new.names = as.vector(matrix(c(current.names,unique.cuisines))) 

for(i in 1:length(unique.cuisines)){
  zomato[,paste(i)] = rep(0,nrow(zomato))
}

names(zomato) = new.names

for(i in 1:length(unique.cuisines)){
zomato[,unique.cuisines[i]] = ifelse(grepl(unique.cuisines[i],zomato$Cuisines),1,0)
}


# Aggregate new variables 
zomato = zomato[, `:=`(European = French+European+Italian+German+
                                  Mediterranean+Greek+Spanish+Irish+
                                  British+Portuguese+Scottish+Belgian,
                       Asian = Japanese+Chinese+Asian+Filipino+Korean+
                               Vietnamese+Thai+Singaporean+Malaysian+
                               Indonesian+Taiwanese+Cantonese+Malay+
                               Peranakan+Sunda,
                       `South American` = Brazilian+Mexican+Peruvian+
                                          `Latin American`+Caribbean+
                                          Cuban+`South American`+Argentine+
                                          Mineira,
                       Indian = Indian+Goan+`South Indian`+`North Indian`+
                                Rajasthani+Mughlai+Mithai+Maharashtrian+
                                `Modern Indian`+Biryani+Parsi+Kashmiri+
                                Bengali+Awadhi+Lucknowi+Gujarati+Oriya+
                                Hyderabadi+Bihari+Kerala+Andhra+Malwani+
                                Assamese+Naga+Chettinad+Mangalorean,
                       American = American+Hawaiian+`New American`+Cajun+Canadian,
                       `Middle Eastern` = `Middle Eastern`+Arabian+Lebanese+
                                          Turkish+Pakistani+Persian+Burmese+Tibetan+
                                          Afghani+Nepalese+Iranian+Izgara+Armenian+Durban,
                       Other = `Bar Food`+International+Steak+BBQ+Southern+Breakfast+
                               Sandwich+`Modern Australian`+African+`North Eastern`+`Tex-Mex`+
                               `Cuisine Varies`+`Charcoal Grill`+`Asian Fusion`+Kiwi+Contemporary+
                               Ramen+Grill+`Sri Lankan`+Kebab+`World Cuisine`+`Turkish Pizza`+
                               `Restaurant Cafe`+Southwestern+Diner+Teriyaki+Vegetarian+
                               Fusion+Deli+`Fish and Chips`+`Dim Sum`+Curry+`South African`+
                               Bí_rek+`Soul Food`+Moroccan+Dí_ner+`Pub Food`+Tapas+Western+
                               Australian+Sushi+Salad,
                       Desserts = Desserts+`Ice Cream`+Patisserie,
                       `Fast Food` = `Fast Food`+`Gourmet Fast Food`,
                       Beverages = Beverages+Juices+`Coffee and Tea`+Tea+`Drinks Only`+`Bubble Tea`)]

zomato = zomato[, `:=`(French=NULL,Italian=NULL,German=NULL,
                    Mediterranean=NULL,Greek=NULL,Spanish=NULL,Irish=NULL,
                    British=NULL,Portuguese=NULL,Scottish=NULL,Belgian=NULL,
                    Japanese=NULL,Chinese=NULL,Filipino=NULL,Korean=NULL,
                    Vietnamese=NULL,Thai=NULL,Singaporean=NULL,Malaysian=NULL,
                    Indonesian=NULL,Taiwanese=NULL,Cantonese=NULL,Malay=NULL,
                    Peranakan=NULL,Sunda=NULL,
                    Brazilian=NULL,Mexican=NULL,Peruvian=NULL,
                    `Latin American`=NULL,Caribbean=NULL,
                    Cuban=NULL,Argentine=NULL,Mineira=NULL,
                    Goan=NULL,`South Indian`=NULL,`North Indian`=NULL,
                    Rajasthani=NULL,Mughlai=NULL,Mithai=NULL,Maharashtrian=NULL,
                    `Modern Indian`=NULL,Biryani=NULL,Parsi=NULL,Kashmiri=NULL,
                    Bengali=NULL,Awadhi=NULL,Lucknowi=NULL,Gujarati=NULL,Oriya=NULL,
                    Hyderabadi=NULL,Bihari=NULL,Kerala=NULL,Andhra=NULL,Malwani=NULL,
                    Assamese=NULL,Naga=NULL,Chettinad=NULL,Mangalorean=NULL,
                    American=NULL,Hawaiian=NULL,`New American`=NULL,Cajun=NULL,Canadian=NULL,
                    `Middle Eastern`=NULL,Arabian=NULL,Lebanese=NULL,
                    Turkish=NULL,Pakistani=NULL,Persian=NULL,Burmese=NULL,Tibetan=NULL,
                    Afghani=NULL,Nepalese=NULL,Iranian=NULL,Izgara=NULL,Armenian=NULL,Durban=NULL,
                    `Bar Food`=NULL,International=NULL,Steak=NULL,BBQ=NULL,Southern=NULL,Breakfast=NULL,
                    Sandwich=NULL,`Modern Australian`=NULL,African=NULL,`North Eastern`=NULL,`Tex-Mex`=NULL,
                    `Cuisine Varies`=NULL,`Charcoal Grill`=NULL,`Asian Fusion`=NULL,Kiwi=NULL,Contemporary=NULL,
                    Ramen=NULL,Grill=NULL,`Sri Lankan`=NULL,Kebab=NULL,`World Cuisine`=NULL,`Turkish Pizza`=NULL,
                    `Restaurant Cafe`=NULL,Southwestern=NULL,Diner=NULL,Teriyaki=NULL,Vegetarian=NULL,
                    Fusion=NULL,Deli=NULL,`Fish and Chips`=NULL,`Dim Sum`=NULL,Curry=NULL,`South African`=NULL,
                    Bí_rek=NULL,`Soul Food`=NULL,Moroccan=NULL,Dí_ner=NULL,`Pub Food`=NULL,Tapas=NULL,
                    Western=NULL,Australian=NULL,Sushi=NULL,`Ice Cream`=NULL,Patisserie=NULL,
                    `Gourmet Fast Food`=NULL,Salad=NULL,Juices=NULL,`Coffee and Tea`=NULL,
                    Tea=NULL,`Drinks Only`=NULL,`Bubble Tea`=NULL)]


# Make variables binary again
for(j in names(zomato)[-c(1:21)]){
  set(zomato, i= which(zomato[[j]]>1), j= j, value= 1)
}   

# Map country code to country
zomato = merge(zomato,countries,by = "Country.Code")
zomato = zomato[,Country.Code := NULL]

# Remove remaining unnecessary variables
zomato = zomato[,c("Restaurant.ID","Restaurant.Name","Address",
                   "Locality","Locality.Verbose","Cuisines",
                   "Is.delivering.now","Switch.to.order.menu",
                   "City","Currency","Rating.color"):=NULL]


#Converting yes/no cols to numeric
zomato$Has.Table.booking <- revalue(zomato$Has.Table.booking, c("No"=0, "Yes"=1))
zomato$Has.Online.delivery <- revalue(zomato$Has.Online.delivery, c("No"=0, "Yes"=1))

#Aggregating country into continent(maybe leave india on its own?)
Europe <- c("United Kingdom")
North_America <- c("United States","Canada")
Asia <- c("India","Indonesia","Singapore","Sri Lanka","UAE","Phillipines","Qatar")
Oceania <- c("Australia", "New Zealand")
ROW <- c("Brazil","South Africa", "Turkey")

zomato$continent = zomato$Country

levels(zomato$continent)[levels(zomato$continent) %in% Europe] = "Europe"
levels(zomato$continent)[levels(zomato$continent) %in% North_America] = "North America"
levels(zomato$continent)[levels(zomato$continent) %in% Asia] = "Asia"
levels(zomato$continent)[levels(zomato$continent) %in% Oceania] = "Oceania"
levels(zomato$continent)[levels(zomato$continent) %in% ROW] = "Rest of World"

zomato$Country<-NULL

#converting continent to binary
setDT(zomato)[, c(levels(zomato$continent), "continent") := 
            c(lapply(levels(continent), function(x) as.integer(x == continent)), .(NULL))]

#creating new variable for range of cuisine

zomato$Cuisine_Range = rowSums(zomato[,10:27])

```


```{r, message = FALSE, warning=FALSE, echo=FALSE}
kable(as.data.frame(summarizeColumns(zomato)),
      caption = "Feature summary after data preprocessing.",
      digits = 3) %>% 
  kable_styling(latex_options = c("scale_down","HOLD_position"))

```

```{r, message = FALSE, warning=FALSE, echo=FALSE}
cols <- names(zomato)[1:3]
df = str_format(zomato[,(cols) := round(.SD,3), .SDcols=cols])

kable(df, caption = "Variable summary for the Zomato dataset after preprocessing\n9551 Observations of 21 Variables",
        format = "latex") %>% kable_styling(latex_options = c("scale_down","HOLD_position"))
```

```{r, message = FALSE, warning=FALSE, echo=FALSE}
# get column tables after cleaning
col.freq = list()
for (i in (1:ncol(zomato))){
  col.freq[[i]] = table(zomato[,..i], dnn = colnames(zomato)[i])
}

col.freq[c(4:6,8,10:33)] %>% kable(caption = "Contingency tables for discrete and categorical variables.",
                                  format = "latex", booktabs = TRUE) %>% 
  kable_styling(latex_options = "HOLD_position")
```


# Data Visualisation

#Univariate and Bivariate

Initially, the proportions of the different levels of the rating response variable were examined.

```{r}
prop = table(zomato$Rating.text) %>% prop.table() %>% as.data.frame()
prop$Freq = prop$Freq*100

c_palette<-c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f")

ggplot(data = prop, aes(x = factor(1), y = Freq, fill = Var1)) +
  geom_bar(stat="identity",width = 1) + coord_polar(theta = "y") +
  ditch_the_axes +
  labs(fill = "Rating", title = "Figure 1. Restaurant Rating Percentage Distribution") +
  geom_text(aes(label = paste(round(Freq,2),"%")), position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values=c_palette)
```

Here it can be seen that the majority of restaurant ratings in the dataset were average. Only a small portion received a rating of either poor or excellent. Furthermore, more than 20% of restaurants in the dataset were not rated. (filter?)

Next, the average cost of meal was considered both on its own and with respect to ratings. The associated visualisations are shown in Figures 2 and 3, respectively.

```{r}
ggplot(zomato, aes(x=Average.Cost.for.two.Std)) +
  geom_histogram(aes(y=..density..)) + 
  geom_density(aes(y=..density..),fill=c_palette[4],alpha=.5)+
  theme_minimal()+labs(title="Figure 2. Distribution of Standardised Average Cost",
                       x="Standardised Avergage Cost",
                       y="Density")
```


```{r, warning=FALSE}
ggplot(zomato, aes(x=Average.Cost.for.two.Std)) +   
  geom_histogram(aes(y=..density..)) + 
  geom_density(aes(y=..density..),fill=c_palette[4],alpha=.5)+
  facet_wrap(~Rating.text)+
  theme_minimal()+labs(title="Figure 3. Distribution of Standardised Average Cost for Two by Rating",
                       x="Standardised Avergage Cost",
                       y="Density")
```

Figure 2 gives a general idea of the average cost for all restaurants included in the dataset. Evidently, the distribution has normal-like qualities with respect to its bell-shaped curve. There is, however, a clear spike in restaurants which may be considered to have a very expensive average cost. From Figure 3, it is clear that all rating levels have a similar distribution to Figure 2, however the spike in expensive average meal cost can be seen to become more profound as rating goes up towards excellent. This would suggest that high rated restaurants are more likely to be more expensive on average.

Next, the binary variable describing whether or not a restaurant had the option to book a table was considered on it own and according to restaurant rating.

```{r}
ggplot(zomato,aes(x=Has.Table.booking))+
  geom_bar(fill=c_palette[4])+
  theme_minimal()+labs(title="Figure 4. Count of Table Booking Status",
                       x="Table Booking",
                       y="Count")
```

```{r}
table_rate <- table(zomato$Has.Table.booking,zomato$Rating.text, dnn = c("Table Booking","Rating"))
prop.table_rate<-data.frame(prop.table(table_rate,1))
colnames(prop.table_rate) <- c("Table Booking","Rating","Proportion")

p1<-ggplot(prop.table_rate,aes(x=`Table Booking`,y=Proportion,fill=Rating))
p1+geom_bar(stat="identity",position="dodge")+
  labs(title="Figure 5. Proportions of Rating by Table Booking Status") +
  theme_minimal()+
  scale_fill_manual(values=c_palette)
```

Figure 4 shows that overall, there are much more restaurants which do not offer table booking in the present sample than those that do. Figure 5 bypasses this issues by examining the relative proportions of rating within each level. Here, the option of booking a table can be seen to have some effect on the rating of a restaurant, with restaurants which do offer table booking having higher propotions of good and very good ratings.

Similar visualisations were used to compare the effect of having online delivery with regard to ratings, as shown in Figures 6 and 7.

```{r}
ggplot(zomato,aes(x=Has.Online.delivery))+
  geom_bar(fill=c_palette[4])+
  theme_minimal()+labs(title="Figure 6. Count of Online Delivery Status",
                       x="Online Delivery",
                       y="Count")
```

```{r}
del_rate <- table(zomato$Has.Online.delivery,zomato$Rating.text, dnn = c("Online Delivery","Rating"))
prop.del_rate<-data.frame(prop.table(del_rate,1))
colnames(prop.del_rate) <- c("Online Delivery","Rating","Proportion")

p2<-ggplot(prop.del_rate,aes(x=`Online Delivery`,y=Proportion,fill=Rating))
p2+geom_bar(stat="identity",position="dodge")+
  labs(title="Figure 7. Proportions of Rating by Online Delivery Status") +
  theme_minimal()+
  scale_fill_manual(values=c_palette)
```

From Figure 6 it can be seen that restaurants which do not offer online delivery are more prevalent in the dataset than those which do offer it. Figure 7 suggests that having the option of online delivery has little effect on restaurant ratings (aside from restaurants which do not have online delivery being more likely to not be rated).

Next, the amount of customer votes each restaurant received was considered. Due to issues with scale, the log transformation was applied to customer votes.

```{r}
ggplot(data = zomato, aes(x = log(Votes+1))) +
  geom_histogram(aes(y=..density..)) + 
  geom_density(aes(y=..density..),fill=c_palette[4],alpha=.5)+
  labs(x = "Log of Votes",
       title = "Figure 8. Distribution of Log of Customer Votes")
```

```{r}
ggplot(zomato, aes(x=log(Votes+1))) +   
  geom_histogram(aes(y=..density..)) + 
  geom_density(aes(y=..density..),fill=c_palette[4],alpha=.4)+
  facet_wrap(~Rating.text)+
  theme_minimal()+labs(title="Figure 9. Distributions of Log of Customer Votes by Rating",
                       x="Log of Votes",
                       y="Density")
```

Figure 8 demonstrates a fairly normal distribution, with clear deviations in the left tail. This may be attributable to restaurants which reeceive zero votes. A trend can be observed within Figure 9, wherein higher ratings appear to be associated with more votes. This trend is however disrupted for restaurants which receive an average rating, which seem to have fewer votes on average. This may be due to customers being more likely to convey an underwhelming experience at a poor-rated restaurant than a mediocre experiences at an average-rated restaurant.

The continent the restuarant was located in was then considered. Figure 10 below depicts a world map of the location of all restaurants within the dataset. Figure 11 then considers the proportional distribtuion of ratings across the continents.

```{r}
WorldData <- map_data('world')
WorldData <- WorldData %>% filter(region != "Antarctica")
WorldData <- tidy(WorldData)


p <- ggplot()
p <- p + geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="antiquewhite", colour="#7f7f7f", size=0.5) +
  geom_point(data = zomato, aes(x = Longitude, y = Latitude),colour = "red4") +
  coord_map("rectangular", lat0=0, xlim=c(-180,180), ylim=c(-60, 90)) +
  scale_y_continuous(breaks=c()) +
  scale_x_continuous(breaks=c()) +
  labs(fill="legend", title="Figure 10. Restaurant Locations", x="", y="") +
  theme_bw() +
  theme(panel.border = element_blank())
```

```{r}
cont_rate <- table(zomato$continent,zomato$Rating.text, dnn = c("Continent","Rating"))
prop.cont_rate<-data.frame(prop.table(cont_rate,1))
colnames(prop.cont_rate) <- c("Continent","Rating","Proportion")

p3<-ggplot(prop.cont_rate,aes(x=Continent,y=Proportion,fill=Rating))
p3+geom_bar(stat="identity",position="dodge")+
  labs(title="Figure 11. Proportions of Rating within Continent") +
  theme_minimal()+
  scale_fill_manual(values=c_palette)
```

...Map Interpretation...

Inspection of Figure 11 highlights that despite being overrepresented in the data, Asian restaurants have relatively low proportions of very good and excellent rated restaurants in comparison to other continents. (Asia has the highest proprotion of not rated restaurants). North America appears to have a relatively high proportion of good-rated restaurants and Europe has the highest proportion of excellent-rated restaurants.

The counts of the different restaurant cuisines were then visualised in Figure 12. Figure 13 considers the cuisine type with respect to rating, but here, the continous aggregate rating variable was used over the discrete version for simplicity and interpretability. 

```{r}
ggplot(data=zomato,aes(x=cuisine))+
  geom_bar(fill=c_palette[4])+theme_minimal()+
  labs(title="Figure 12. Count of Restaurant Cuisine",
       x="Cuisine",
       y="Count")+
  theme(axis.text.x = element_text(angle = 45))
```

```{r}
ggplot(data = zomato, aes(y = Aggregate.rating, x = "")) +
  geom_boxplot(fill = c_palette[4]) + facet_wrap(~cuisine, ncol = 6) +
  theme_minimal() + labs(title = "Figure 13. Aggregate Restaurant Rating by Cuisine",
                         y = "Aggregate Rating",
                         x = "Cuisine")
```

From Figure 12, it is clear that the restaurants included in this sample mostly belong to either Indian or Asian cuisines. Figure 13 highlights that almost all cuisines are centered around an aggregate rating of 3 to 4, which would equate to ratings of good and very good, respectively. Furthermore, most cuisine types appear to have very little variablity, however others, such as bakery, beverages, street food, Indian and raw meats are shown to have a very large interquartile range. This suggests high variability in the aggregate ratings of these kinds of restaurants.

#Multivariate

```{r}
ggplot(data=zomato, aes(x=log(Votes+1), y=Average.Cost.for.two.Std)) +
  geom_point(aes(colour=continent),alpha=.25) +
  facet_wrap(~Rating.text)+
  labs(title="Figure 14. Standardised Average Cost by Log of Votes across Continent",
       x="Votes",
       y="Average Cost for Two (Standardised)")+
  scale_colour_manual(values=c_palette,name = "Continent")+theme_minimal()+
  guides(colour = guide_legend(override.aes = list(alpha=1)))
```

Figure 14 serves to highlight several interesting features within the sample. Foremost, the imbalance of data across the continents as well as rating levels is very clear. The abundance of aqua suggests that most of the restaurants are from Asia, while the density of points also shows that most of the restaurants received an average rating. Furthermore, the disperson of points in all facets demonstrates that there is no apparent relationship between the cost of a meal and the amount of votes a restaurant receives. It also seems that Asian restaurants are overrepresented in the average and not rated levels, while there is a more even distribution of the continents across the other rating levels. This is besides for the excellent rating, where the proportion of Asian restaurants is relatively low.

```{r}
ggplot(zomato,aes(x=log(Votes+1),fill=Has.Table.booking))+
  geom_density(alpha=0.5)+facet_grid(continent~Rating.text)+
  theme_minimal()+
  labs(title="Figure 15. Distribution of Log of Votes by Table Booking Status\n across Rating and Continent",
       x="Log of Votes",
       y="Density")
```

Figure 15 examines how the number of votes a restaurant receives is influenced by its rating, continent and whether table booking is available. There is clearly some issues with data sparsity evidenced by the empty facets. The imbalance of the table booking variable can also be seen with restaurants in Asia being the only ones which consistently have table bookings avaialbe for each rating level. Based on this, as well as the other facets which allow for comparison for the two table booking levels, it can be seen that typically the mode of votes is higher for restaurants which offer table booking compared to those which do not.

```{r}
ggplot(zomato,aes(x=continent,y=Average.Cost.for.two.Std))+
  geom_boxplot(aes(fill=Rating.text))+theme_minimal()+
  stat_summary(fun.y = mean, aes(shape="Continent\nMean"), colour = "darkred", geom="point",size=4) +
  scale_shape_manual("", values=c("Continent\nMean"="\u2666"))+
  scale_fill_manual(values=c_palette,name = "Rating")+
  labs(title="Figure 16. Standardised Average Cost for Two \nby Continent and Rating",
       y="Standardised Average Cost",
       x="Continent")
```


# Summary

\newpage

# References

---
nocite: | 
  @mlr, @data.table, @dplyr, @plyr, @ggplot2, @broom,  @vcd, @knitr, @kableExtra,
...


